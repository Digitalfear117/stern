{# templates/base.html #}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="{{ description or 'Titanic Â» A private server for osu! that lets you experience the early days of the game.' }}">
    <meta name="keywords" content="osu, lekuru, server, titanic, titanic, private server, old osu, nostalgia, 2013, 2012, 2011, 2010, 2009, 2008, 2007, ouendan, elite, beat, agents, windows, game, taiko, tatsujin, simulator, sim, xna, ddr, beatmania, osu!, osume" />
    <meta name="viewport" content="width=865, user-scalable=yes"/>
    <meta name="msapplication-TileColor" content="#603cba">
    <meta name="theme-color" content="#ffffff">
    <meta property="og:site_name" content="Titanic">
    <meta property="og:type" content="website">
    <meta name="theme-color" content="#603cba">
    {% if site_description %}<meta property="og:description" content="{{ site_description }}">{% endif %}
    {% if site_title %}<meta property="og:title" content="{{ site_title }}">{% endif %}
    {% if site_image %}<meta property="og:image" content="{{ site_image }}">{% endif %}
    {% if site_url %}<meta property="og:url" content="{{ site_url }}">{% endif %}
    <title>{{ title or 'Titanic' }}</title>
    <script src="/js/jquery.min.js"></script>
    <script src="/js/jquery.timeago.js"></script>
    <script src="/js/d3.v3.js"></script>
    <script src="/js/nv.d3.js"></script>
    <link rel="stylesheet" href="/css/{{ css or 'main.css' }}">
    <link rel="stylesheet" href="/css/nv.d3.min.css">
    <link rel="stylesheet" href="/css/fontawesome.min.css">
    <link rel="stylesheet" href="/css/fontawesome.solid.min.css">
    <link rel="stylesheet" href="/css/fontawesome.brands.min.css">
    <script>
        const domainName = "{{ config.DOMAIN_NAME }}";
        const enableSSL = {{ config.ENABLE_SSL|lower }};
        const currentUser = {{ current_user.id if not current_user.is_anonymous else 'null' }};
    </script>
</head>
<body>
    <div class="main">
        <img src="/images/logo/headerlogo@0,25x.png" class="logo" loading="eager" alt="">
        <div class="nav">
            {% include "navigation.html" %}
        </div>
        <div class="bancho-stats">
            <b>{{ total_users }}</b> users, <b>{{ online_users }}</b> online now.<br>
            A total of <b>{{ total_scores }}</b> plays!
        </div>
        <div class="content">
            <div class="top">
                <div class="search-container">
                    <form class="search-form" onsubmit="return beatmapSearch()">
                        <input class="nav-search" type="text" id="beatmap-search" name="beatmaps" placeholder="Beatmap" autocomplete="off">
                    </form>
                    <form class="search-form" onsubmit="return userSearch()">
                        <input class="nav-search" type="text" id="user-search" name="users" placeholder="User" autocomplete="off">
                    </form>
                </div>
                <div class="login-container">
                {% if current_user.id %}
                    <p class="nav-login" id="welcome-text">
                        Welcome, <a href="/u/{{ current_user.id }}">{{ current_user.name }}</a>
                    </p>
                    <a href="/account/settings/profile#avatar">
                        <img class="small-avatar" src="/a/{{ current_user.id }}?h=25" alt="" height="25px">
                    </a>
                    <a href="/account/settings"><i class="fa-solid fa-gear" style="color: #808080;"></i> Settings</a>
                    <a href="/account/settings#notifications">
                        <i class="fa-solid fa-bell" style="color: #808080;"></i>
                        {% if notification_count > 0 %}
                        {{ notification_count }} {{ 'notification' if notification_count == 1 else 'notifications' }}
                        {% else %}
                        No notifications
                        {% endif %}
                    </a>
                    <a href="/account/logout?redirect={{ url_for(request.endpoint, **request.view_args) }}">
                        <i class="fa-solid fa-power-off" style="color: #808080;"></i> Logout
                    </a>
                {% else %}
                    <p class="nav-login" id="welcome-text">Welcome, guest!</p>
                    <a onclick="showLoginForm()" class="nav-login" id="login-text">Login</a>
                    <a href="/account/register" class="nav-login" id="register-text">I'm new!</a>
                {% endif %}
                </div>
            </div>
            <div class="login-dropdown" style="display: none;">
                <form action="/account/login" method="post">
                    <input type="hidden" name="redirect" value="{{ url_for(request.endpoint, **request.view_args) }}">
                    Please enter your credentials:
                    <br>
                    <input id="username-field" class="post" type="text" name="username" placeholder="Username" maxlength="30" value="" tabindex="0" autocomplete="off">
                    <br>
                    <input id="password-field" class="post" type="password" name="password" placeholder="Password" tabindex="0" autocomplete="off">
                    <br>
                    <div>
                        <input id="remember" class="radio" type="checkbox" name="remember">
                        <label for="remember">Remember Me</label>
                        <input class="login-button" type="submit" name="login" value="Login" tabindex="5">
                    </div>
                    <div class="login-bottom-text">
                        <a id="forgot-password-text" href="/account/reset">
                            Forgot your password?
                        </a>
                    </div>
                    <div class="login-bottom-text">
                        <a id="register-text" href="/account/register">
                            Create new account!
                        </a>
                    </div>
                </form>
            </div>
            <div class="page">
                {# User Permissions #}
                {% if not current_user.is_anonymous and current_user.groups %}
                    {% set current_user_group_ids = current_user.groups|get_attributes('group_id') %}
                    {% set current_user_is_admin = (1 in current_user_group_ids) or
                                                   (2 in current_user_group_ids) or
                                                   (4 in current_user_group_ids) %}
                    {% set current_user_is_bat = (1 in current_user_group_ids) or
                                                 (3 in current_user_group_ids) %}
                {% else %}
                    {% set current_user_is_admin = False %}
                    {% set current_user_is_bat = False %}
                {% endif %}
                {# Page Content #}
                {% block content %}
                {% endblock content %}
            </div>
            <div class="gradient"></div>
        </div>
    </div>
    <script src="/js/main.js"></script>
    <script>
        {% if show_login %}
        showLoginForm();
        {% endif %}
        {% if alert %}
        alert("{{ alert }}");
        {% endif %}
    </script>
</body>
</html>