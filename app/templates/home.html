{# templates/home.html #}

{% extends "base.html" %}

{% block content %}
<div class="content-wrapper">
    <div class="left-side">
        <div class="about-wrapper">
            <div class="blurb-box">
                <div class="blurb-text" id="about-header">
                    Welcome to <b>osu!Titanic</b>
                </div>
                <div class="blurb-text">
                    Titanic is an <a href="https://osu.ppy.sh">osu!</a> private server dedicated to preserving the nostalgia of osu!'s earlier days, offering players the opportunity to experience the game using client versions from 2008 to 2013.
                    It's also a community-driven project that is fully open source and open to a all kinds of contribution. Even just a simple suggestion can make a big change.
                    So, welcome on board, and enjoy your stay!
                </div>
            </div>
        </div>

        <div class="news-wrapper">
            <h2 class="headers">News</h2>
            {% for message in news %}
                <div class="news">
                    <div class="blurb-heading">
                        {{ message['date'] }} <a href="{{ message['link'] }}"><b>{{ message['title'] }}</b></a> ({{ message['author'] }})
                    </div>
                    <div class="blurb-box">
                        <div class="blurb-text">
                            {{ message['text'] }}
                        </div>
                    </div>
                    <div class="blurb-readmore">
                        <a href="{{ message['link'] }}">Read More / Comment...</a>
                    </div>
                </div>
            {% endfor %}
        </div>

        <div class="bottom-stats">
            <div class="stats-wrapper">
                <h2 class="headers">Online Users<span>Over the last 24 hours</span></h2>
                <img src="/graph/useractivity.png" alt="User Activity">
            </div>

            <div class="chat-wrapper">
                <h2 class="headers">Chat</h2>
                <table class="styled-table">
                    <tbody>
                    {% for message in messages %}
                        {% if loop.index0 % 2 %}
                            <tr class="light-row">
                        {% else %}
                            <tr class="dark-row">
                        {% endif %}
                            <td style="color: grey; width: 10%">{{ message.time.strftime("%H:%M:%S") }}</th>
                            <td>
                                {{ message.sender }}: {{ message.message }}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <div class="right-side">
        <!-- Placeholder -->
        <a href="/p/download">
            <img src="/images/home/download.png" alt="Download"/>
        </a>
        <!-- Placeholder -->
        <a href="/p/market">
            <img src="/images/home/goodies.png" alt="Market"/>
        </a>
        <!-- Placeholder -->
        <a href="/p/support">
            <img src="/images/home/support.png" alt="Support"/>
        </a>
        <div class="featured">
            <h2 class="headers">Featured Video</h2>
            <iframe title="Featured" width="356" height="278" type="text/html" style="border: 0;" allowfullscreen src="https://www.youtube.com/embed/{{ featured_video_id }}?autoplay=1&mute=1&showinfo=0&controls=0"></iframe>
        </div>
        <div class="most-played">
            <h2 class="headers">
                Most Played Beatmaps
                <!-- TODO: Last 24 hours lol -->
                <!-- <span>Over the last 24 hours</span> -->
            </h2>
            <table class="styled-table">
                <thead>
                    <tr>
                      <th scope="col">Plays</th>
                      <th scope="col" style="text-align: center;">Artist / Title</th>
                      <th scope="col">Creator</th>
                    </tr>
                </thead>
                <tbody>
                {% for count, set in beatmapsets %}
                    {% if loop.index0 % 2 %}
                        <tr class="light-row">
                    {% else %}
                        <tr class="dark-row">
                    {% endif %}
                        <td>{{ count }}</th>
                        <td>
                            <a href="/s/{{ set.id }}">
                                <img src="https://s.lekuru.xyz/mt/{{ set.id }}" alt="image"/>
                                {{ set.full_name }}
                            </a>
                        </td>
                    {% if set.server == 0 %}
                        <td><a href="https://osu.ppy.sh/u/{{ set.creator }}">{{ set.creator }}</a></td>
                    {% else %}
                        <td><a href="/u/{{ set.creator }}">{{ set.creator }}</a></td>
                    {% endif %}
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>
{% endblock content %}